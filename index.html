<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sport op TV Vanavond</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #1a73e8;
            --primary-dark: #1557b0;
            --bg: #f5f7fa;
            --card-bg: #ffffff;
            --text: #202124;
            --text-secondary: #5f6368;
            --border: #e0e0e0;
            --success: #34a853;
            --football: #4caf50;
            --darts: #ff5722;
            --f1: #e10600;
            --shadow: 0 2px 8px rgba(0,0,0,0.08);
            --shadow-hover: 0 4px 16px rgba(0,0,0,0.12);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 12px 0 16px;
        }

        header h1 {
            font-size: clamp(1.5rem, 4vw, 2rem);
            font-weight: 700;
        }

        /* Sport Tabs */
        .sport-tabs {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        .sport-tab {
            padding: 12px 28px;
            border: none;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            background: var(--card-bg);
            color: var(--text-secondary);
            box-shadow: var(--shadow);
        }

        .sport-tab:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .sport-tab.active[data-sport="voetbal"] {
            background: var(--football);
            color: white;
        }

        .sport-tab.active[data-sport="darts"] {
            background: var(--darts);
            color: white;
        }

        .sport-tab.active[data-sport="f1"] {
            background: var(--f1);
            color: white;
        }

        /* Filters Row - Clean & Minimal */
        .filters-row {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }

        /* Dropdown */
        .dropdown {
            position: relative;
        }

        .dropdown-btn {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 0.85rem;
            background: white;
            color: var(--text);
            cursor: pointer;
            min-width: 140px;
            text-align: left;
        }

        .dropdown-btn:hover {
            border-color: #bbb;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            border: 1px solid #ddd;
            border-radius: 6px;
            box-shadow: var(--shadow-hover);
            z-index: 100;
            min-width: 180px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 4px;
        }

        .dropdown-content.show {
            display: block;
        }

        .dropdown-content label {
            display: block;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 0.85rem;
        }

        .dropdown-content label:hover {
            background: #f5f5f5;
        }

        .dropdown-content input[type="checkbox"] {
            margin-right: 8px;
        }

        .dropdown-content hr {
            border: none;
            border-top: 1px solid #eee;
            margin: 4px 0;
        }

        .reset-btn {
            padding: 6px 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: white;
            color: #666;
            cursor: pointer;
            font-size: 1rem;
        }

        .reset-btn:hover {
            background: #f5f5f5;
            color: var(--primary);
        }

        /* Standings toggle */
        .view-toggle {
            display: flex;
            justify-content: center;
            gap: 0;
            margin-bottom: 16px;
        }

        .view-btn {
            padding: 8px 20px;
            border: 1px solid #ddd;
            background: white;
            cursor: pointer;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .view-btn:first-child {
            border-radius: 6px 0 0 6px;
        }

        .view-btn:last-child {
            border-radius: 0 6px 6px 0;
            border-left: none;
        }

        .view-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* Standings table */
        .standings-container {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 16px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
        }

        .standings-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--border);
        }

        .standings-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }

        .standings-table th {
            text-align: left;
            padding: 8px 4px;
            color: var(--text-secondary);
            font-weight: 500;
            border-bottom: 1px solid #eee;
        }

        .standings-table td {
            padding: 10px 4px;
            border-bottom: 1px solid #f5f5f5;
        }

        .standings-table tr:last-child td {
            border-bottom: none;
        }

        .standings-table .pos {
            width: 30px;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .standings-table .team {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .standings-table .team-logo {
            width: 20px;
            height: 20px;
            object-fit: contain;
        }

        .standings-table .pts {
            font-weight: 700;
            text-align: right;
        }

        .standings-table .stats {
            color: var(--text-secondary);
            text-align: center;
        }

        .standings-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }

        .standings-tab {
            padding: 6px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: white;
            cursor: pointer;
            font-size: 0.8rem;
        }

        .standings-tab.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* Expandable darts matches */
        .event-card.has-matches {
            cursor: pointer;
        }

        .event-card.has-matches:hover {
            background: #fafafa;
        }

        .matches-list {
            display: none;
            grid-column: 1 / -1;
            padding-top: 12px;
            margin-top: 12px;
            border-top: 1px solid #eee;
        }

        .event-card.expanded .matches-list {
            display: block;
        }

        .match-item {
            display: flex;
            align-items: center;
            padding: 8px 0;
            font-size: 0.9rem;
            color: var(--text);
            border-bottom: 1px solid #f0f0f0;
        }

        .match-item:last-child {
            border-bottom: none;
        }

        .match-item .match-time {
            min-width: 50px;
            color: var(--darts);
            font-weight: 600;
            margin-right: 12px;
        }

        .match-item .vs {
            margin: 0 8px;
            color: #999;
        }

        .expand-icon {
            font-size: 0.8rem;
            color: #999;
            margin-left: 8px;
        }

        .event-card.expanded .expand-icon {
            transform: rotate(180deg);
        }

        .filter-input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 0.85rem;
            width: 140px;
        }

        .filter-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .filter-input::placeholder {
            color: #aaa;
        }

        .filters-spacer {
            flex: 1;
        }

        /* Toggle Section */
        .toggle-section {
            display: flex;
            gap: 16px;
            align-items: center;
        }

        .slim-toggle {
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            user-select: none;
        }

        .slim-toggle input {
            display: none;
        }

        .slim-toggle .slider {
            width: 32px;
            height: 18px;
            background: #ddd;
            border-radius: 9px;
            position: relative;
            transition: background 0.2s;
        }

        .slim-toggle .slider::after {
            content: '';
            position: absolute;
            width: 14px;
            height: 14px;
            background: white;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: transform 0.2s;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }

        .slim-toggle input:checked + .slider {
            background: var(--primary);
        }

        .slim-toggle input:checked + .slider::after {
            transform: translateX(14px);
        }

        .slim-toggle .label {
            font-size: 0.8rem;
            color: #666;
        }

        @media (max-width: 600px) {
            .filters-row {
                flex-direction: column;
                align-items: stretch;
            }

            .filter-select, .filter-input {
                width: 100%;
            }

            .filters-spacer {
                display: none;
            }

            .toggle-section {
                justify-content: center;
                padding-top: 8px;
            }
        }

        /* Event Cards */
        .events-container {
            margin-top: 20px;
        }

        .day-section {
            margin-bottom: 32px;
        }

        .day-header {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 2px solid var(--border);
        }

        .event-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 16px 20px;
            margin-bottom: 12px;
            box-shadow: var(--shadow);
            transition: all 0.2s ease;
            display: grid;
            grid-template-columns: 55px 1fr 50px 80px;
            gap: 12px;
            align-items: center;
        }

        .event-card:hover {
            box-shadow: var(--shadow-hover);
            transform: translateY(-2px);
        }

        .event-time {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary);
        }

        .event-details {
            flex: 1;
        }

        .event-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .event-meta {
            display: flex;
            gap: 16px;
            color: var(--text-secondary);
            font-size: 0.9rem;
            flex-wrap: wrap;
        }

        .event-meta span {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .event-channel {
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 80px;
        }

        .channel-logo {
            height: 28px;
            width: auto;
            border-radius: 4px;
        }

        .channel-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.9rem;
            text-align: center;
        }

        /* Club logos */
        .club-logo {
            height: 24px;
            width: 24px;
            object-fit: contain;
            vertical-align: middle;
            margin: 0 6px;
            border-radius: 2px;
        }

        .club-logo[src=""] {
            display: none;
        }

        .team-name {
            vertical-align: middle;
        }

        /* Past events styling */
        .past-day {
            opacity: 0.7;
        }

        .past-day .day-header {
            color: #888;
        }

        .past-event {
            background: #f5f5f5;
        }

        /* Score column */
        .event-score-col {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--success);
            text-align: center;
            min-width: 50px;
            visibility: hidden;
        }

        .show-scores .event-score-col {
            visibility: visible;
        }

        .event-score-col.no-score {
            color: #ccc;
        }

        /* Live indicator */
        .live-badge {
            background: #e10600;
            color: white;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* Competition badge */
        .competition-badge {
            background: var(--bg);
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.85rem;
        }

        /* Loading & Error states */
        .loading {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .loading .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 16px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .error-message {
            text-align: center;
            padding: 40px 20px;
            color: #d32f2f;
            background: #ffebee;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        /* No events message */
        .no-events {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .no-events .icon {
            font-size: 4rem;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .no-events h3 {
            font-size: 1.3rem;
            margin-bottom: 8px;
        }

        /* API Status */
        .api-status {
            text-align: center;
            padding: 4px;
            font-size: 0.7rem;
            color: #999;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .refresh-btn {
            background: none;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 2px 8px;
            font-size: 0.7rem;
            cursor: pointer;
            color: #666;
        }

        .refresh-btn:hover {
            background: #f5f5f5;
            color: var(--primary);
        }

        .api-status .live-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: var(--success);
            border-radius: 50%;
            margin-right: 6px;
            animation: pulse 2s infinite;
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Responsive */
        @media (max-width: 600px) {
            .container {
                padding: 12px;
            }

            .event-card {
                grid-template-columns: 50px 1fr 40px;
                gap: 8px;
            }

            .event-card .event-channel {
                display: none;
            }

            .event-time {
                font-size: 1rem;
            }

            .event-score-col {
                font-size: 0.9rem;
            }

            .sport-tab {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
        }

        /* Sport-specific accent colors */
        .sport-voetbal .event-time { color: var(--football); }
        .sport-darts .event-time { color: var(--darts); }
        .sport-f1 .event-time { color: var(--f1); }

        .sport-voetbal .day-header { border-color: var(--football); }
        .sport-darts .day-header { border-color: var(--darts); }
        .sport-f1 .day-header { border-color: var(--f1); }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Sport op TV</h1>
        </header>

        <!-- Sport Tabs -->
        <div class="sport-tabs">
            <button class="sport-tab active" data-sport="voetbal">Voetbal</button>
            <button class="sport-tab" data-sport="darts">Darts</button>
            <button class="sport-tab" data-sport="f1">Formule 1</button>
        </div>

        <!-- Filters Panel -->
        <div class="filters-row" id="filters-row">
            <div class="dropdown" id="comp-dropdown">
                <button class="dropdown-btn" id="comp-btn">Competities â–¾</button>
                <div class="dropdown-content" id="comp-content">
                    <label><input type="checkbox" value="Eredivisie"> Eredivisie</label>
                    <label><input type="checkbox" value="Premier League"> Premier League</label>
                    <label><input type="checkbox" value="Bundesliga"> Bundesliga</label>
                    <label><input type="checkbox" value="La Liga"> La Liga</label>
                    <label><input type="checkbox" value="Serie A"> Serie A</label>
                    <label><input type="checkbox" value="Ligue 1"> Ligue 1</label>
                    <hr>
                    <label><input type="checkbox" value="Champions League"> Champions League</label>
                    <label><input type="checkbox" value="Europa League"> Europa League</label>
                    <label><input type="checkbox" value="Conference League"> Conference League</label>
                    <hr>
                    <label><input type="checkbox" value="FA Cup"> FA Cup</label>
                    <label><input type="checkbox" value="League Cup"> League Cup</label>
                    <label><input type="checkbox" value="Coppa Italia"> Coppa Italia</label>
                    <label><input type="checkbox" value="DFB Pokal"> DFB Pokal</label>
                    <label><input type="checkbox" value="Copa del Rey"> Copa del Rey</label>
                    <label><input type="checkbox" value="KNVB Beker"> KNVB Beker</label>
                </div>
            </div>
            <input type="text" class="filter-input" id="filter-clubs" placeholder="Clubs (komma)...">
            <button class="reset-btn" id="reset-filters" title="Herstel filters">&#x21bb;</button>
            <div class="filters-spacer"></div>
            <div class="toggle-section">
                <label class="slim-toggle">
                    <input type="checkbox" id="toggle-past">
                    <span class="slider"></span>
                    <span class="label">Verleden</span>
                </label>
                <label class="slim-toggle">
                    <input type="checkbox" id="toggle-scores">
                    <span class="slider"></span>
                    <span class="label">Uitslagen</span>
                </label>
            </div>
        </div>

        <!-- View Toggle -->
        <div class="view-toggle" id="view-toggle">
            <button class="view-btn active" data-view="programma">Programma</button>
            <button class="view-btn" data-view="standen">Standen</button>
        </div>

        <!-- API Status -->
        <div class="api-status" id="api-status">
            <span class="live-dot"></span> <span class="status-text">Laden...</span>
        </div>

        <!-- Events Container -->
        <div class="events-container" id="events-container">
            <!-- Events will be rendered here -->
        </div>

        <!-- Standings Container -->
        <div class="standings-wrapper" id="standings-wrapper" style="display:none;">
            <div class="standings-tabs" id="standings-tabs"></div>
            <div id="standings-content"></div>
        </div>

        <footer>
            <p>Sport op TV &mdash; Geen reclame, gewoon overzicht</p>
            <p style="margin-top: 8px; font-size: 0.8rem;">
                Data: API-Football, OpenF1
            </p>
        </footer>
    </div>

    <script>
        console.log('ðŸš€ Script starting...');

        // ============================================
        // CONFIGURATION
        // ============================================
        const CONFIG = {
            // API-Football key (gratis 100 requests/dag op api-football.com)
            API_FOOTBALL_KEY: '6299b9b25468371fa7878f188ca297c0',
            API_FOOTBALL_URL: 'https://v3.football.api-sports.io',

            // API-Football league IDs voor relevante competities
            API_FOOTBALL_LEAGUES: [
                // Leagues
                { id: 88, name: 'Eredivisie', channel: 'ESPN' },
                { id: 39, name: 'Premier League', channel: 'Viaplay' },
                { id: 78, name: 'Bundesliga', channel: 'Viaplay' },
                { id: 140, name: 'La Liga', channel: 'Ziggo Sport' },
                { id: 135, name: 'Serie A', channel: 'Ziggo Sport' },
                { id: 61, name: 'Ligue 1', channel: 'Ziggo Sport' },
                // Cups
                { id: 45, name: 'FA Cup', channel: 'Viaplay' },
                { id: 48, name: 'League Cup', channel: 'Viaplay' },
                { id: 137, name: 'Coppa Italia', channel: 'Ziggo Sport' },
                { id: 81, name: 'DFB Pokal', channel: 'Viaplay' },
                { id: 143, name: 'Copa del Rey', channel: 'Ziggo Sport' },
                { id: 66, name: 'Coupe de France', channel: 'Ziggo Sport' },
                { id: 102, name: 'KNVB Beker', channel: 'ESPN' },
                // European
                { id: 2, name: 'Champions League', channel: 'Ziggo Sport' },
                { id: 3, name: 'Europa League', channel: 'Ziggo Sport' },
                { id: 848, name: 'Conference League', channel: 'Ziggo Sport' }
            ],

            // OpenF1 API (gratis, geen key nodig)
            F1_API_URL: 'https://api.openf1.org/v1',

            // TheSportsDB API (gratis, geen key nodig - key 3 is free tier)
            THESPORTSDB_URL: 'https://www.thesportsdb.com/api/v1/json/3',
            DARTS_LEAGUE_ID: '4554', // PDC Darts

            // Competities voor OpenFootball
            LEAGUES: [
                { file: 'nl.1.json', name: 'Eredivisie', channel: 'ESPN' },
                { file: 'en.1.json', name: 'Premier League', channel: 'Viaplay' },
                { file: 'de.1.json', name: 'Bundesliga', channel: 'Viaplay' },
                { file: 'es.1.json', name: 'La Liga', channel: 'Ziggo Sport' },
                { file: 'it.1.json', name: 'Serie A', channel: 'Ziggo Sport' },
                { file: 'fr.1.json', name: 'Ligue 1', channel: 'Ziggo Sport' }
            ],

            // Nederlandse TV zenders mapping
            TV_CHANNELS: {
                'Eredivisie': 'ESPN',
                'Premier League': 'Viaplay',
                'Primera Division': 'Ziggo Sport',
                'La Liga': 'Ziggo Sport',
                'Bundesliga': 'Viaplay',
                'Serie A': 'Ziggo Sport',
                'Ligue 1': 'Ziggo Sport',
                'FA Cup': 'Viaplay',
                'League Cup': 'Viaplay',
                'Coppa Italia': 'Ziggo Sport',
                'DFB Pokal': 'Viaplay',
                'Copa del Rey': 'Ziggo Sport',
                'Coupe de France': 'Ziggo Sport',
                'KNVB Beker': 'ESPN',
                'Champions League': 'Ziggo Sport',
                'Europa League': 'Ziggo Sport',
                'Conference League': 'Ziggo Sport',
                'Formula 1': 'Viaplay',
                'Darts': 'Viaplay / RTL7'
            },

            // TV kanaal logo's (inline SVG data URLs - fully encoded)
            CHANNEL_LOGOS: {
                'ESPN': 'data:image/svg+xml,%3Csvg xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22 viewBox%3D%220 0 100 40%22%3E%3Crect fill%3D%22%23d00%22 width%3D%22100%22 height%3D%2240%22 rx%3D%224%22%2F%3E%3Ctext x%3D%2250%22 y%3D%2228%22 fill%3D%22white%22 font-family%3D%22Arial%22 font-size%3D%2218%22 text-anchor%3D%22middle%22 font-weight%3D%22bold%22%3EESPN%3C%2Ftext%3E%3C%2Fsvg%3E',
                'Viaplay': 'data:image/svg+xml,%3Csvg xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22 viewBox%3D%220 0 100 40%22%3E%3Crect fill%3D%22%236b21a8%22 width%3D%22100%22 height%3D%2240%22 rx%3D%224%22%2F%3E%3Ctext x%3D%2250%22 y%3D%2227%22 fill%3D%22white%22 font-family%3D%22Arial%22 font-size%3D%2214%22 text-anchor%3D%22middle%22 font-weight%3D%22bold%22%3EVIAPLAY%3C%2Ftext%3E%3C%2Fsvg%3E',
                'Ziggo Sport': 'data:image/svg+xml,%3Csvg xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22 viewBox%3D%220 0 100 40%22%3E%3Crect fill%3D%22%23f60%22 width%3D%22100%22 height%3D%2240%22 rx%3D%224%22%2F%3E%3Ctext x%3D%2250%22 y%3D%2227%22 fill%3D%22white%22 font-family%3D%22Arial%22 font-size%3D%2212%22 text-anchor%3D%22middle%22 font-weight%3D%22bold%22%3EZIGGO%3C%2Ftext%3E%3C%2Fsvg%3E',
                'RTL7': 'data:image/svg+xml,%3Csvg xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22 viewBox%3D%220 0 100 40%22%3E%3Crect fill%3D%22%2300a0e1%22 width%3D%22100%22 height%3D%2240%22 rx%3D%224%22%2F%3E%3Ctext x%3D%2250%22 y%3D%2228%22 fill%3D%22white%22 font-family%3D%22Arial%22 font-size%3D%2216%22 text-anchor%3D%22middle%22 font-weight%3D%22bold%22%3ERTL7%3C%2Ftext%3E%3C%2Fsvg%3E',
                'Viaplay / RTL7': 'data:image/svg+xml,%3Csvg xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22 viewBox%3D%220 0 100 40%22%3E%3Crect fill%3D%22%236b21a8%22 width%3D%2250%22 height%3D%2240%22%2F%3E%3Crect x%3D%2250%22 fill%3D%22%2300a0e1%22 width%3D%2250%22 height%3D%2240%22%2F%3E%3Ctext x%3D%2225%22 y%3D%2225%22 fill%3D%22white%22 font-family%3D%22Arial%22 font-size%3D%228%22 text-anchor%3D%22middle%22%3EVIA%3C%2Ftext%3E%3Ctext x%3D%2275%22 y%3D%2225%22 fill%3D%22white%22 font-family%3D%22Arial%22 font-size%3D%229%22 text-anchor%3D%22middle%22%3ERTL7%3C%2Ftext%3E%3C%2Fsvg%3E'
            }
        };

        // ============================================
        // STATE
        // ============================================
        let currentSport = 'voetbal';
        let currentView = 'programma'; // 'programma' or 'standen'
        let showScores = false;
        let showPast = false;
        // Load filters from localStorage (with error handling)
        let filters = { competitions: [], clubs: [] };
        try {
            const savedComps = localStorage.getItem('selectedCompetitions');
            const savedClubs = localStorage.getItem('selectedClubs');
            if (savedComps) filters.competitions = JSON.parse(savedComps) || [];
            if (savedClubs) filters.clubs = JSON.parse(savedClubs) || [];
            // Ensure arrays
            if (!Array.isArray(filters.competitions)) filters.competitions = [];
            if (!Array.isArray(filters.clubs)) filters.clubs = [];
        } catch (e) {
            console.warn('Could not load filters from localStorage:', e);
            localStorage.removeItem('selectedCompetitions');
            localStorage.removeItem('selectedClubs');
        }
        let cachedData = {
            voetbal: null,
            darts: null,
            f1: null
        };

        // ============================================
        // DARTS DATA 2026 - Premier League Darts & Major Events
        // ============================================
        // Spelers
        const dartsPlayers = {
            'Littler': {name: 'Luke Littler'},
            'Humphries': {name: 'Luke Humphries'},
            'Van Gerwen': {name: 'Michael van Gerwen'},
            'Rock': {name: 'Josh Rock'},
            'Clayton': {name: 'Jonny Clayton'},
            'Bunting': {name: 'Stephen Bunting'},
            'Price': {name: 'Gerwyn Price'},
            'Van Veen': {name: 'Gian van Veen'}
        };

        const dartsCalendar = [
            // Premier League Darts 2026 - Echte schema's met tijden
            { date: '2026-02-05', time: '20:00', event: 'Premier League Darts - Avond 1', location: 'Belfast', channel: 'Viaplay', matches: [
                {time: '20:10', home: 'Humphries', away: 'Van Veen'},
                {time: '20:40', home: 'Van Gerwen', away: 'Clayton'},
                {time: '21:10', home: 'Bunting', away: 'Rock'},
                {time: '21:40', home: 'Littler', away: 'Price'}
            ]},
            { date: '2026-02-12', time: '20:00', event: 'Premier League Darts - Avond 2', location: 'Cardiff', channel: 'Viaplay', matches: [
                {time: '20:10', home: 'Littler', away: 'Humphries'},
                {time: '20:40', home: 'Van Gerwen', away: 'Rock'},
                {time: '21:10', home: 'Clayton', away: 'Bunting'},
                {time: '21:40', home: 'Price', away: 'Van Veen'}
            ]},
            { date: '2026-02-19', time: '20:00', event: 'Premier League Darts - Avond 3', location: 'Liverpool', channel: 'Viaplay', matches: [
                {time: '20:10', home: 'Bunting', away: 'Van Veen'},
                {time: '20:40', home: 'Humphries', away: 'Rock'},
                {time: '21:10', home: 'Van Gerwen', away: 'Littler'},
                {time: '21:40', home: 'Clayton', away: 'Price'}
            ]},
            { date: '2026-02-26', time: '20:00', event: 'Premier League Darts - Avond 4', location: 'Manchester', channel: 'Viaplay', matches: [
                {time: '20:10', home: 'Littler', away: 'Clayton'},
                {time: '20:40', home: 'Bunting', away: 'Humphries'},
                {time: '21:10', home: 'Van Gerwen', away: 'Price'},
                {time: '21:40', home: 'Van Veen', away: 'Rock'}
            ]},
            { date: '2026-03-05', time: '20:00', event: 'Premier League Darts - Avond 5', location: 'Exeter', channel: 'Viaplay', matches: [
                {time: '20:10', home: 'Van Gerwen', away: 'Humphries'},
                {time: '20:40', home: 'Van Veen', away: 'Clayton'},
                {time: '21:10', home: 'Price', away: 'Bunting'},
                {time: '21:40', home: 'Littler', away: 'Rock'}
            ]},
            { date: '2026-03-12', time: '20:00', event: 'Premier League Darts - Avond 6', location: 'Rotterdam Ahoy', channel: 'Viaplay', matches: [
                {time: '20:10', home: 'Rock', away: 'Bunting'},
                {time: '20:40', home: 'Clayton', away: 'Van Gerwen'},
                {time: '21:10', home: 'Humphries', away: 'Van Veen'},
                {time: '21:40', home: 'Price', away: 'Littler'}
            ]},
            { date: '2026-03-19', time: '20:00', event: 'Premier League Darts - Avond 7', location: 'Newcastle', channel: 'Viaplay', matches: [
                {time: '20:10', home: 'Van Veen', away: 'Van Gerwen'},
                {time: '20:40', home: 'Bunting', away: 'Littler'},
                {time: '21:10', home: 'Rock', away: 'Price'},
                {time: '21:40', home: 'Clayton', away: 'Humphries'}
            ]},
            { date: '2026-03-26', time: '20:00', event: 'Premier League Darts - Avond 8', location: 'Sheffield', channel: 'Viaplay', matches: [
                {time: '20:10', home: 'TBD', away: 'TBD'},
                {time: '20:40', home: 'TBD', away: 'TBD'},
                {time: '21:10', home: 'TBD', away: 'TBD'},
                {time: '21:40', home: 'TBD', away: 'TBD'}
            ]},
            { date: '2026-04-02', time: '20:00', event: 'Premier League Darts - Avond 9', location: 'Aberdeen', channel: 'Viaplay', matches: [
                {time: '20:10', home: 'Van Gerwen', away: 'Bunting'},
                {time: '20:40', home: 'Price', away: 'Humphries'},
                {time: '21:10', home: 'Van Veen', away: 'Littler'},
                {time: '21:40', home: 'Clayton', away: 'Rock'}
            ]},
            { date: '2026-04-09', time: '20:00', event: 'Premier League Darts - Avond 10', location: 'Dublin', channel: 'Viaplay', matches: [
                {time: '20:10', home: 'Humphries', away: 'Clayton'},
                {time: '20:40', home: 'Price', away: 'Rock'},
                {time: '21:10', home: 'Littler', away: 'Bunting'},
                {time: '21:40', home: 'Van Gerwen', away: 'Van Veen'}
            ]},
            { date: '2026-04-23', time: '20:00', event: 'Premier League Darts - Avond 11', location: 'Birmingham', channel: 'Viaplay', matches: [
                {time: '20:10', home: 'Van Veen', away: 'Price'},
                {time: '20:40', home: 'Bunting', away: 'Clayton'},
                {time: '21:10', home: 'Rock', away: 'Van Gerwen'},
                {time: '21:40', home: 'Humphries', away: 'Littler'}
            ]},
            { date: '2026-04-30', time: '20:00', event: 'Premier League Darts - Avond 13', location: 'Brighton', channel: 'Viaplay', matches: [
                {time: '20:10', home: 'Rock', away: 'Littler'},
                {time: '20:40', home: 'Bunting', away: 'Price'},
                {time: '21:10', home: 'Clayton', away: 'Van Veen'},
                {time: '21:40', home: 'Humphries', away: 'Van Gerwen'}
            ]},
            { date: '2026-05-07', time: '20:00', event: 'Premier League Darts - Avond 14', location: 'Glasgow', channel: 'Viaplay', matches: [
                {time: '20:10', home: 'Price', away: 'Clayton'},
                {time: '20:40', home: 'Littler', away: 'Van Gerwen'},
                {time: '21:10', home: 'Rock', away: 'Humphries'},
                {time: '21:40', home: 'Van Veen', away: 'Bunting'}
            ]},
            { date: '2026-05-14', time: '20:00', event: 'Premier League Darts - Avond 15', location: 'Nottingham', channel: 'Viaplay', matches: [
                {time: '20:10', home: 'Rock', away: 'Van Veen'},
                {time: '20:40', home: 'Price', away: 'Van Gerwen'},
                {time: '21:10', home: 'Humphries', away: 'Bunting'},
                {time: '21:40', home: 'Clayton', away: 'Littler'}
            ]},
            { date: '2026-05-21', time: '19:00', event: 'Premier League Darts - Play-Offs', location: 'London O2', channel: 'Viaplay', matches: [
                {time: '19:30', home: 'Halve Finale 1', away: ''},
                {time: '21:00', home: 'Halve Finale 2', away: ''},
                {time: '22:00', home: 'Finale', away: ''}
            ]},
            // UK Open 2026
            { date: '2026-02-27', time: '13:00', event: 'UK Open', location: 'Minehead', channel: 'Viaplay' },
            { date: '2026-02-28', time: '13:00', event: 'UK Open', location: 'Minehead', channel: 'Viaplay' },
            { date: '2026-03-01', time: '13:00', event: 'UK Open - Finale', location: 'Minehead', channel: 'Viaplay' },
            // World Matchplay 2026
            { date: '2026-07-18', time: '13:00', event: 'World Matchplay', location: 'Blackpool', channel: 'Viaplay' },
            { date: '2026-07-19', time: '19:00', event: 'World Matchplay', location: 'Blackpool', channel: 'Viaplay' },
            { date: '2026-07-25', time: '19:00', event: 'World Matchplay', location: 'Blackpool', channel: 'Viaplay' },
            { date: '2026-07-26', time: '19:00', event: 'World Matchplay - Finale', location: 'Blackpool', channel: 'Viaplay' },
            // World Grand Prix 2026
            { date: '2026-10-04', time: '19:00', event: 'World Grand Prix', location: 'Leicester', channel: 'Viaplay' },
            { date: '2026-10-10', time: '19:00', event: 'World Grand Prix - Finale', location: 'Leicester', channel: 'Viaplay' },
            // Grand Slam of Darts 2026
            { date: '2026-11-07', time: '13:00', event: 'Grand Slam of Darts', location: 'Wolverhampton', channel: 'Viaplay' },
            { date: '2026-11-15', time: '19:00', event: 'Grand Slam of Darts - Finale', location: 'Wolverhampton', channel: 'Viaplay' },
            // Players Championship Finals 2026
            { date: '2026-11-27', time: '13:00', event: 'Players Championship Finals', location: 'Minehead', channel: 'Viaplay' },
            { date: '2026-11-29', time: '19:00', event: 'Players Championship Finals - Finale', location: 'Minehead', channel: 'Viaplay' },
            // World Championship 2026/2027
            { date: '2026-12-15', time: '19:00', event: 'World Championship', location: 'Alexandra Palace', channel: 'Viaplay' },
            { date: '2026-12-22', time: '19:00', event: 'World Championship', location: 'Alexandra Palace', channel: 'Viaplay' },
            { date: '2026-12-29', time: '19:00', event: 'World Championship', location: 'Alexandra Palace', channel: 'Viaplay' },
        ];

        // ============================================
        // API FUNCTIONS
        // ============================================

        // Fetch F1 sessions from OpenF1 API
        async function fetchF1Sessions() {
            try {
                const response = await fetch(`${CONFIG.F1_API_URL}/sessions?year=2026`);
                if (!response.ok) throw new Error('F1 API error');
                const sessions = await response.json();

                return sessions.map(session => ({
                    date: new Date(session.date_start),
                    time: new Date(session.date_start).toLocaleTimeString('nl-NL', { hour: '2-digit', minute: '2-digit' }),
                    title: session.session_name,
                    competition: `GP ${session.country_name}`,
                    circuit: session.circuit_short_name,
                    channel: 'Viaplay',
                    type: session.session_type,
                    live: isLiveNow(session.date_start, session.date_end),
                    score: null
                }));
            } catch (error) {
                console.error('F1 API Error:', error);
                return [];
            }
        }

        // Static football data (iservoetbalvanavond.nl fallback)
        function getStaticFootballMatches() {
            const matches = [
                // VERLEDEN - met uitslagen
                // 2 feb 2026
                { date: '2026-02-02', time: '18:45', home: 'Ajax', away: 'PSV', competition: 'Eredivisie', channel: 'ESPN', score: '1-2' },
                { date: '2026-02-02', time: '21:00', home: 'Feyenoord', away: 'AZ', competition: 'Eredivisie', channel: 'ESPN', score: '3-1' },
                // 3 feb 2026
                { date: '2026-02-03', time: '20:00', home: 'Manchester City', away: 'Liverpool', competition: 'Premier League', channel: 'Viaplay', score: '2-2' },
                { date: '2026-02-03', time: '20:45', home: 'Real Madrid', away: 'AtlÃ©tico Madrid', competition: 'La Liga', channel: 'Ziggo Sport', score: '3-1' },
                // 5 feb 2026
                { date: '2026-02-05', time: '20:00', home: 'Bayern MÃ¼nchen', away: 'Dortmund', competition: 'Bundesliga', channel: 'Viaplay', score: '2-1' },
                { date: '2026-02-05', time: '21:00', home: 'Barcelona', away: 'Real Sociedad', competition: 'La Liga', channel: 'Ziggo Sport', score: '4-0' },
                // 7 feb 2026
                { date: '2026-02-07', time: '20:00', home: 'FC Twente', away: 'Feyenoord', competition: 'Eredivisie', channel: 'ESPN', score: '1-1' },
                { date: '2026-02-07', time: '21:00', home: 'Inter', away: 'Juventus', competition: 'Serie A', channel: 'Ziggo Sport', score: '2-0' },
                // 8 feb 2026
                { date: '2026-02-08', time: '13:30', home: 'Arsenal', away: 'Chelsea', competition: 'Premier League', channel: 'Viaplay', score: '2-1' },
                { date: '2026-02-08', time: '16:00', home: 'PSV', away: 'NEC', competition: 'Eredivisie', channel: 'ESPN', score: '4-1' },
                { date: '2026-02-08', time: '18:30', home: 'Napoli', away: 'AC Milan', competition: 'Serie A', channel: 'Ziggo Sport', score: '1-0' },
                { date: '2026-02-08', time: '21:00', home: 'Aston Villa', away: 'Manchester United', competition: 'Premier League', channel: 'Viaplay', score: '3-2' },
                // TOEKOMST
                // 9 feb 2026
                { date: '2026-02-09', time: '17:30', home: 'Atalanta', away: 'Cremonese', competition: 'Serie A', channel: 'Ziggo Sport' },
                { date: '2026-02-09', time: '19:45', home: 'Roma', away: 'Cagliari', competition: 'Serie A', channel: 'Ziggo Sport' },
                { date: '2026-02-09', time: '20:00', home: 'Villarreal', away: 'Espanyol', competition: 'La Liga', channel: 'Ziggo Sport' },
                { date: '2026-02-09', time: '20:45', home: 'FC Porto', away: 'Sporting CP', competition: 'Primeira Liga', channel: 'Ziggo Sport' },
                // 10 feb 2026
                { date: '2026-02-10', time: '19:30', home: 'Tottenham', away: 'Newcastle', competition: 'Premier League', channel: 'Viaplay' },
                { date: '2026-02-10', time: '19:30', home: 'Chelsea', away: 'Leeds United', competition: 'Premier League', channel: 'Viaplay' },
                { date: '2026-02-10', time: '19:30', home: 'Everton', away: 'Bournemouth', competition: 'Premier League', channel: 'Viaplay' },
                { date: '2026-02-10', time: '19:45', home: 'Hertha BSC', away: 'SC Freiburg', competition: 'DFB Pokal', channel: 'Ziggo Sport' },
                { date: '2026-02-10', time: '20:00', home: 'Napoli', away: 'Como', competition: 'Coppa Italia', channel: 'Ziggo Sport' },
                { date: '2026-02-10', time: '20:15', home: 'West Ham', away: 'Manchester United', competition: 'Premier League', channel: 'Viaplay' },
                // 11 feb 2026
                { date: '2026-02-11', time: '17:45', home: 'Go Ahead Eagles', away: 'sc Heerenveen', competition: 'Eredivisie', channel: 'ESPN' },
                { date: '2026-02-11', time: '19:30', home: 'Nottingham Forest', away: 'Wolverhampton', competition: 'Premier League', channel: 'Viaplay' },
                { date: '2026-02-11', time: '19:30', home: 'Aston Villa', away: 'Brighton', competition: 'Premier League', channel: 'Viaplay' },
                { date: '2026-02-11', time: '19:30', home: 'Crystal Palace', away: 'Burnley', competition: 'Premier League', channel: 'Viaplay' },
                { date: '2026-02-11', time: '19:30', home: 'Manchester City', away: 'Fulham', competition: 'Premier League', channel: 'Viaplay' },
                { date: '2026-02-11', time: '19:45', home: 'Bayern MÃ¼nchen', away: 'RB Leipzig', competition: 'DFB Pokal', channel: 'Ziggo Sport' },
                { date: '2026-02-11', time: '20:00', home: 'NEC', away: 'FC Utrecht', competition: 'Eredivisie', channel: 'ESPN' },
                { date: '2026-02-11', time: '20:00', home: 'Athletic Bilbao', away: 'Real Sociedad', competition: 'Copa del Rey', channel: 'Ziggo Sport' },
                { date: '2026-02-11', time: '20:15', home: 'Sunderland', away: 'Liverpool', competition: 'Premier League', channel: 'Viaplay' },
                // 12 feb 2026
                { date: '2026-02-12', time: '20:00', home: 'AtlÃ©tico Madrid', away: 'Barcelona', competition: 'Copa del Rey', channel: 'Ziggo Sport' },
                // 13 feb 2026
                { date: '2026-02-13', time: '20:00', home: 'FC Volendam', away: 'PSV', competition: 'Eredivisie', channel: 'ESPN' },
                { date: '2026-02-13', time: '21:00', home: 'Ajax', away: 'Fortuna Sittard', competition: 'Eredivisie', channel: 'ESPN' },
                // 14 feb 2026
                { date: '2026-02-14', time: '18:45', home: 'Sparta Rotterdam', away: 'AZ', competition: 'Eredivisie', channel: 'ESPN' },
                { date: '2026-02-14', time: '21:00', home: 'Feyenoord', away: 'Go Ahead Eagles', competition: 'Eredivisie', channel: 'ESPN' },
                // 15 feb 2026
                { date: '2026-02-15', time: '12:30', home: 'FC Twente', away: 'NEC', competition: 'Eredivisie', channel: 'ESPN' },
                { date: '2026-02-15', time: '14:30', home: 'sc Heerenveen', away: 'FC Utrecht', competition: 'Eredivisie', channel: 'ESPN' },
                { date: '2026-02-15', time: '16:45', home: 'Heracles', away: 'Ajax', competition: 'Eredivisie', channel: 'ESPN' },
            ];

            return matches.map(m => ({
                date: new Date(m.date + 'T' + m.time),
                time: m.time,
                home: m.home,
                away: m.away,
                competition: m.competition,
                channel: m.channel,
                score: m.score || null,
                live: false,
                status: m.score ? 'FINISHED' : 'SCHEDULED',
                isStatic: true
            }));
        }

        // Fetch football matches - try API-Football first, fall back to cache
        async function fetchFootballMatches() {
            console.log('Fetching football matches...');

            // Check localStorage cache first (valid for 6 hours)
            const cached = localStorage.getItem('footballCache');
            const cacheTime = localStorage.getItem('footballCacheTime');
            const cacheValid = cached && cacheTime && (Date.now() - parseInt(cacheTime)) < 6 * 60 * 60 * 1000;

            if (cacheValid) {
                console.log('Using cached football data (cache valid for 6 hours)');
                const data = JSON.parse(cached);
                return data.map(m => ({ ...m, date: new Date(m.date) }));
            }

            // Try API-Football
            const allMatches = [];
            const today = new Date();
            const season = today.getMonth() >= 7 ? today.getFullYear() : today.getFullYear() - 1;
            let apiErrors = 0;
            let rateLimited = false;

            for (const league of CONFIG.API_FOOTBALL_LEAGUES) {
                if (rateLimited) break;

                try {
                    const response = await fetch(
                        `${CONFIG.API_FOOTBALL_URL}/fixtures?league=${league.id}&season=${season}&from=${getDateStr(-7)}&to=${getDateStr(14)}`,
                        { headers: { 'x-apisports-key': CONFIG.API_FOOTBALL_KEY } }
                    );

                    if (!response.ok) {
                        apiErrors++;
                        continue;
                    }

                    const data = await response.json();

                    if (data.errors && data.errors.requests) {
                        console.warn('API rate limit reached');
                        rateLimited = true;
                        break;
                    }

                    if (data.response && data.response.length > 0) {
                        data.response.forEach(match => {
                            const matchDate = new Date(match.fixture.date);
                            allMatches.push({
                                date: matchDate,
                                time: matchDate.toLocaleTimeString('nl-NL', { hour: '2-digit', minute: '2-digit' }),
                                home: match.teams.home.name,
                                away: match.teams.away.name,
                                homeCrest: match.teams.home.logo,
                                awayCrest: match.teams.away.logo,
                                competition: league.name,
                                channel: league.channel,
                                score: match.goals.home !== null ? `${match.goals.home}-${match.goals.away}` : null,
                                live: ['1H', '2H', 'HT', 'ET', 'P'].includes(match.fixture.status.short),
                                status: match.fixture.status.short
                            });
                        });
                    }
                } catch (error) {
                    apiErrors++;
                }
            }

            // If we got fresh data, cache it
            if (allMatches.length > 0) {
                localStorage.setItem('footballCache', JSON.stringify(allMatches));
                localStorage.setItem('footballCacheTime', Date.now().toString());
                localStorage.setItem('footballSource', 'api');
                return allMatches;
            }

            // API failed - use old cache if available (regardless of age)
            if (cached) {
                console.log('API unavailable, using cached data');
                localStorage.setItem('footballSource', 'cache');
                const data = JSON.parse(cached);
                return data.map(m => ({ ...m, date: new Date(m.date) }));
            }

            // No cache - use static fallback data
            console.log('Using static fallback data');
            localStorage.setItem('footballSource', 'static');
            return getStaticFootballMatches();
        }

        // Helper function for date strings
        function getDateStr(daysFromNow) {
            const d = new Date();
            d.setDate(d.getDate() + daysFromNow);
            return d.toISOString().split('T')[0];
        }

        // Fetch football standings with caching
        async function fetchFootballStandings(leagueId) {
            // Check cache first
            const cacheKey = `standings_${leagueId}`;
            const cached = localStorage.getItem(cacheKey);
            const cacheTime = localStorage.getItem(cacheKey + '_time');

            if (cached && cacheTime && (Date.now() - parseInt(cacheTime)) < 24 * 60 * 60 * 1000) {
                console.log(`Using cached standings for league ${leagueId}`);
                return JSON.parse(cached);
            }

            const season = new Date().getMonth() >= 7 ? new Date().getFullYear() : new Date().getFullYear() - 1;
            try {
                const response = await fetch(
                    `${CONFIG.API_FOOTBALL_URL}/standings?league=${leagueId}&season=${season}`,
                    { headers: { 'x-apisports-key': CONFIG.API_FOOTBALL_KEY } }
                );
                if (!response.ok) throw new Error('API error');
                const data = await response.json();

                if (data.errors && data.errors.requests) {
                    console.warn('Standings API rate limited');
                    // Return cached data if available (even if old)
                    if (cached) return JSON.parse(cached);
                    // Return fallback static data
                    return getStaticStandings(leagueId);
                }

                if (data.response && data.response[0] && data.response[0].league.standings) {
                    const standings = data.response[0].league.standings[0];
                    // Cache the result
                    localStorage.setItem(cacheKey, JSON.stringify(standings));
                    localStorage.setItem(cacheKey + '_time', Date.now().toString());
                    return standings;
                }
            } catch (e) {
                console.error('Standings fetch error:', e);
                // Return cached or fallback
                if (cached) return JSON.parse(cached);
                return getStaticStandings(leagueId);
            }
            return getStaticStandings(leagueId);
        }

        // Static standings fallback (February 2026 data)
        function getStaticStandings(leagueId) {
            const standings = {
                // Eredivisie (bijgewerkt 8 feb 2026)
                88: [
                    { rank: 1, team: { name: 'PSV', logo: '' }, all: { win: 18, draw: 2, lose: 1 }, goalsDiff: 39, points: 56 },
                    { rank: 2, team: { name: 'NEC', logo: '' }, all: { win: 12, draw: 5, lose: 4 }, goalsDiff: 21, points: 41 },
                    { rank: 3, team: { name: 'Feyenoord', logo: '' }, all: { win: 12, draw: 3, lose: 6 }, goalsDiff: 19, points: 39 },
                    { rank: 4, team: { name: 'Ajax', logo: '' }, all: { win: 10, draw: 8, lose: 3 }, goalsDiff: 13, points: 38 },
                    { rank: 5, team: { name: 'AZ', logo: '' }, all: { win: 10, draw: 3, lose: 8 }, goalsDiff: 8, points: 33 },
                    { rank: 6, team: { name: 'FC Twente', logo: '' }, all: { win: 9, draw: 5, lose: 7 }, goalsDiff: 5, points: 32 },
                    { rank: 7, team: { name: 'FC Utrecht', logo: '' }, all: { win: 9, draw: 4, lose: 8 }, goalsDiff: 3, points: 31 },
                    { rank: 8, team: { name: 'Sparta Rotterdam', logo: '' }, all: { win: 8, draw: 6, lose: 7 }, goalsDiff: 0, points: 30 },
                ],
                // Premier League (bijgewerkt 8 feb 2026)
                39: [
                    { rank: 1, team: { name: 'Arsenal', logo: '' }, all: { win: 17, draw: 5, lose: 3 }, goalsDiff: 32, points: 56 },
                    { rank: 2, team: { name: 'Manchester City', logo: '' }, all: { win: 14, draw: 5, lose: 5 }, goalsDiff: 26, points: 47 },
                    { rank: 3, team: { name: 'Aston Villa', logo: '' }, all: { win: 14, draw: 5, lose: 6 }, goalsDiff: 9, points: 47 },
                    { rank: 4, team: { name: 'Manchester United', logo: '' }, all: { win: 12, draw: 8, lose: 5 }, goalsDiff: 10, points: 44 },
                    { rank: 5, team: { name: 'Chelsea', logo: '' }, all: { win: 12, draw: 7, lose: 6 }, goalsDiff: 17, points: 43 },
                    { rank: 6, team: { name: 'Liverpool', logo: '' }, all: { win: 11, draw: 6, lose: 7 }, goalsDiff: 6, points: 39 },
                    { rank: 7, team: { name: 'Newcastle', logo: '' }, all: { win: 10, draw: 8, lose: 7 }, goalsDiff: 5, points: 38 },
                    { rank: 8, team: { name: 'Brighton', logo: '' }, all: { win: 10, draw: 6, lose: 9 }, goalsDiff: 3, points: 36 },
                ],
                // Bundesliga
                78: [
                    { rank: 1, team: { name: 'Bayern MÃ¼nchen', logo: '' }, all: { win: 14, draw: 4, lose: 2 }, goalsDiff: 32, points: 46 },
                    { rank: 2, team: { name: 'Bayer Leverkusen', logo: '' }, all: { win: 13, draw: 5, lose: 2 }, goalsDiff: 28, points: 44 },
                    { rank: 3, team: { name: 'Eintracht Frankfurt', logo: '' }, all: { win: 11, draw: 5, lose: 4 }, goalsDiff: 18, points: 38 },
                    { rank: 4, team: { name: 'RB Leipzig', logo: '' }, all: { win: 10, draw: 6, lose: 4 }, goalsDiff: 14, points: 36 },
                    { rank: 5, team: { name: 'Borussia Dortmund', logo: '' }, all: { win: 10, draw: 5, lose: 5 }, goalsDiff: 15, points: 35 },
                    { rank: 6, team: { name: 'Mainz 05', logo: '' }, all: { win: 9, draw: 6, lose: 5 }, goalsDiff: 6, points: 33 },
                    { rank: 7, team: { name: 'Freiburg', logo: '' }, all: { win: 9, draw: 5, lose: 6 }, goalsDiff: 4, points: 32 },
                    { rank: 8, team: { name: 'Werder Bremen', logo: '' }, all: { win: 8, draw: 5, lose: 7 }, goalsDiff: 0, points: 29 },
                ],
                // La Liga
                140: [
                    { rank: 1, team: { name: 'Barcelona', logo: '' }, all: { win: 16, draw: 4, lose: 2 }, goalsDiff: 35, points: 52 },
                    { rank: 2, team: { name: 'Real Madrid', logo: '' }, all: { win: 14, draw: 5, lose: 3 }, goalsDiff: 25, points: 47 },
                    { rank: 3, team: { name: 'AtlÃ©tico Madrid', logo: '' }, all: { win: 13, draw: 5, lose: 4 }, goalsDiff: 18, points: 44 },
                    { rank: 4, team: { name: 'Athletic Bilbao', logo: '' }, all: { win: 11, draw: 7, lose: 4 }, goalsDiff: 14, points: 40 },
                    { rank: 5, team: { name: 'Villarreal', logo: '' }, all: { win: 10, draw: 7, lose: 5 }, goalsDiff: 10, points: 37 },
                    { rank: 6, team: { name: 'Real Betis', logo: '' }, all: { win: 9, draw: 8, lose: 5 }, goalsDiff: 6, points: 35 },
                    { rank: 7, team: { name: 'Real Sociedad', logo: '' }, all: { win: 8, draw: 9, lose: 5 }, goalsDiff: 4, points: 33 },
                    { rank: 8, team: { name: 'Mallorca', logo: '' }, all: { win: 8, draw: 7, lose: 7 }, goalsDiff: 0, points: 31 },
                ],
                // Serie A
                135: [
                    { rank: 1, team: { name: 'Napoli', logo: '' }, all: { win: 16, draw: 4, lose: 2 }, goalsDiff: 28, points: 52 },
                    { rank: 2, team: { name: 'Inter', logo: '' }, all: { win: 15, draw: 5, lose: 2 }, goalsDiff: 30, points: 50 },
                    { rank: 3, team: { name: 'Atalanta', logo: '' }, all: { win: 14, draw: 4, lose: 4 }, goalsDiff: 24, points: 46 },
                    { rank: 4, team: { name: 'Lazio', logo: '' }, all: { win: 13, draw: 4, lose: 5 }, goalsDiff: 16, points: 43 },
                    { rank: 5, team: { name: 'Juventus', logo: '' }, all: { win: 10, draw: 10, lose: 2 }, goalsDiff: 14, points: 40 },
                    { rank: 6, team: { name: 'Fiorentina', logo: '' }, all: { win: 10, draw: 6, lose: 6 }, goalsDiff: 8, points: 36 },
                    { rank: 7, team: { name: 'Bologna', logo: '' }, all: { win: 9, draw: 7, lose: 6 }, goalsDiff: 5, points: 34 },
                    { rank: 8, team: { name: 'AC Milan', logo: '' }, all: { win: 9, draw: 6, lose: 7 }, goalsDiff: 6, points: 33 },
                ],
                // Ligue 1
                61: [
                    { rank: 1, team: { name: 'PSG', logo: '' }, all: { win: 16, draw: 4, lose: 2 }, goalsDiff: 35, points: 52 },
                    { rank: 2, team: { name: 'Marseille', logo: '' }, all: { win: 13, draw: 5, lose: 4 }, goalsDiff: 18, points: 44 },
                    { rank: 3, team: { name: 'Monaco', logo: '' }, all: { win: 12, draw: 5, lose: 5 }, goalsDiff: 12, points: 41 },
                    { rank: 4, team: { name: 'Lille', logo: '' }, all: { win: 11, draw: 6, lose: 5 }, goalsDiff: 10, points: 39 },
                    { rank: 5, team: { name: 'Lyon', logo: '' }, all: { win: 10, draw: 7, lose: 5 }, goalsDiff: 8, points: 37 },
                    { rank: 6, team: { name: 'Nice', logo: '' }, all: { win: 9, draw: 8, lose: 5 }, goalsDiff: 5, points: 35 },
                    { rank: 7, team: { name: 'Lens', logo: '' }, all: { win: 9, draw: 6, lose: 7 }, goalsDiff: 3, points: 33 },
                    { rank: 8, team: { name: 'Strasbourg', logo: '' }, all: { win: 8, draw: 7, lose: 7 }, goalsDiff: 0, points: 31 },
                ],
                // Champions League - League Phase eindstand (top 8 direct naar R16)
                2: [
                    { rank: 1, team: { name: 'Arsenal', logo: '' }, all: { win: 6, draw: 2, lose: 0 }, goalsDiff: 14, points: 20 },
                    { rank: 2, team: { name: 'Bayern MÃ¼nchen', logo: '' }, all: { win: 6, draw: 1, lose: 1 }, goalsDiff: 12, points: 19 },
                    { rank: 3, team: { name: 'Liverpool', logo: '' }, all: { win: 6, draw: 1, lose: 1 }, goalsDiff: 11, points: 19 },
                    { rank: 4, team: { name: 'Tottenham', logo: '' }, all: { win: 5, draw: 2, lose: 1 }, goalsDiff: 8, points: 17 },
                    { rank: 5, team: { name: 'Barcelona', logo: '' }, all: { win: 5, draw: 2, lose: 1 }, goalsDiff: 10, points: 17 },
                    { rank: 6, team: { name: 'Chelsea', logo: '' }, all: { win: 5, draw: 1, lose: 2 }, goalsDiff: 7, points: 16 },
                    { rank: 7, team: { name: 'Sporting CP', logo: '' }, all: { win: 5, draw: 1, lose: 2 }, goalsDiff: 6, points: 16 },
                    { rank: 8, team: { name: 'Manchester City', logo: '' }, all: { win: 5, draw: 1, lose: 2 }, goalsDiff: 5, points: 16 },
                ]
            };
            return standings[leagueId] || [];
        }

        // Fetch F1 standings from Ergast API
        async function fetchF1Standings() {
            try {
                const [driversRes, constructorsRes] = await Promise.all([
                    fetch('https://ergast.com/api/f1/current/driverStandings.json'),
                    fetch('https://ergast.com/api/f1/current/constructorStandings.json')
                ]);
                const driversData = await driversRes.json();
                const constructorsData = await constructorsRes.json();
                return {
                    drivers: driversData.MRData.StandingsTable.StandingsLists[0]?.DriverStandings || [],
                    constructors: constructorsData.MRData.StandingsTable.StandingsLists[0]?.ConstructorStandings || []
                };
            } catch (e) {
                console.error('F1 standings error:', e);
                return { drivers: [], constructors: [] };
            }
        }

        // PL Darts standings - Na Night 1 Newcastle (5 feb 2026)
        // Punten: 5 = avondwinnaar, 3 = finalist, 2 = halve finale verliezer
        const plDartsStandings = [
            { pos: 1, name: 'Michael van Gerwen', played: 1, sf: 1, f: 1, w: 1, pts: 5 },
            { pos: 2, name: 'Gian van Veen', played: 1, sf: 1, f: 1, w: 0, pts: 3 },
            { pos: 3, name: 'Luke Humphries', played: 1, sf: 1, f: 0, w: 0, pts: 2 },
            { pos: 4, name: 'Jonny Clayton', played: 1, sf: 1, f: 0, w: 0, pts: 2 },
            { pos: 5, name: 'Luke Littler', played: 1, sf: 0, f: 0, w: 0, pts: 0 },
            { pos: 6, name: 'Stephen Bunting', played: 1, sf: 0, f: 0, w: 0, pts: 0 },
            { pos: 7, name: 'Josh Rock', played: 1, sf: 0, f: 0, w: 0, pts: 0 },
            { pos: 8, name: 'Gerwyn Price', played: 1, sf: 0, f: 0, w: 0, pts: 0 }
        ];

        // WK 2026 Groepen (11 juni - 19 juli 2026, USA/Mexico/Canada)
        const wk2026Groups = {
            'A': ['Mexico', 'Zuid-Afrika', 'Zuid-Korea', 'UEFA PO D'],
            'B': ['Canada', 'Zwitserland', 'Qatar', 'UEFA PO A'],
            'C': ['BraziliÃ«', 'Marokko', 'HaÃ¯ti', 'Schotland'],
            'D': ['Verenigde Staten', 'Paraguay', 'AustraliÃ«', 'UEFA PO C'],
            'E': ['Duitsland', 'CuraÃ§ao', 'Ivoorkust', 'Ecuador'],
            'F': ['Nederland', 'Japan', 'TunesiÃ«', 'UEFA PO B'],
            'G': ['BelgiÃ«', 'Egypte', 'Iran', 'Nieuw-Zeeland'],
            'H': ['Spanje', 'KaapverdiÃ«', 'Saudi-ArabiÃ«', 'Uruguay'],
            'I': ['Frankrijk', 'Senegal', 'Noorwegen', 'Intercont. PO 2'],
            'J': ['ArgentiniÃ«', 'Algerije', 'Oostenrijk', 'JordaniÃ«'],
            'K': ['Portugal', 'Oezbekistan', 'Colombia', 'Intercont. PO 1'],
            'L': ['Engeland', 'KroatiÃ«', 'Ghana', 'Panama']
        };

        // WK 2026 Schema - Nederland wedstrijden + knockout rondes
        const wk2026Schedule = {
            nederland: [
                { date: '14 juni', time: '21:00', home: 'Nederland', away: 'Japan', city: 'Philadelphia', stage: 'Groep F' },
                { date: '20 juni', time: '18:00', home: 'Nederland', away: 'UEFA PO B', city: 'Philadelphia', stage: 'Groep F' },
                { date: '25 juni', time: '21:00', home: 'TunesiÃ«', away: 'Nederland', city: 'Kansas City', stage: 'Groep F' }
            ],
            knockout: [
                { stage: 'Ronde van 32', dates: '28 juni - 3 juli' },
                { stage: 'Ronde van 16', dates: '4 - 7 juli' },
                { stage: 'Kwartfinales', dates: '9 & 11 juli' },
                { stage: 'Halve finales', dates: '14 & 15 juli' },
                { stage: 'Troostfinale', dates: '18 juli' },
                { stage: 'Finale', dates: '19 juli', city: 'New Jersey (MetLife Stadium)' }
            ],
            openingMatches: [
                { date: '11 juni', time: '21:00', home: 'Mexico', away: 'Zuid-Afrika', city: 'Mexico City', stage: 'Groep A - Opening' },
                { date: '12 juni', time: '18:00', home: 'Canada', away: 'Zwitserland', city: 'Toronto', stage: 'Groep B' },
                { date: '12 juni', time: '21:00', home: 'Verenigde Staten', away: 'Paraguay', city: 'Los Angeles', stage: 'Groep D' }
            ]
        };

        // Functie om WK groepen te renderen
        function renderWK2026Groups() {
            let html = '<div class="standings-container">';

            // Nederland schema
            html += '<div class="standings-title" style="color:#e65100;">ðŸ‡³ðŸ‡± Nederland - WK 2026 Schema</div>';
            html += '<table class="standings-table"><tr><th>Datum</th><th>Wedstrijd</th><th>Stad</th></tr>';
            wk2026Schedule.nederland.forEach(m => {
                html += `<tr style="background:#fff3e0;">
                    <td>${m.date}<br><small>${m.time}</small></td>
                    <td><strong>${m.home}</strong> - ${m.away}</td>
                    <td>${m.city}</td>
                </tr>`;
            });
            html += '</table>';

            // Knockout schema
            html += '<div class="standings-title" style="margin-top:20px;">Knockout Rondes</div>';
            html += '<table class="standings-table"><tr><th>Ronde</th><th>Data</th><th>Locatie</th></tr>';
            wk2026Schedule.knockout.forEach(k => {
                html += `<tr>
                    <td>${k.stage}</td>
                    <td>${k.dates}</td>
                    <td>${k.city || 'Diverse steden'}</td>
                </tr>`;
            });
            html += '</table>';

            // Opening wedstrijden
            html += '<div class="standings-title" style="margin-top:20px;">Opening Wedstrijden</div>';
            html += '<table class="standings-table"><tr><th>Datum</th><th>Wedstrijd</th><th>Stad</th></tr>';
            wk2026Schedule.openingMatches.forEach(m => {
                html += `<tr>
                    <td>${m.date}<br><small>${m.time}</small></td>
                    <td>${m.home} - ${m.away}<br><small>${m.stage}</small></td>
                    <td>${m.city}</td>
                </tr>`;
            });
            html += '</table>';

            // Alle groepen
            html += '<div class="standings-title" style="margin-top:20px;">Alle Groepen</div>';
            html += '<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:12px;">';

            for (const [group, teams] of Object.entries(wk2026Groups)) {
                const isNLGroup = group === 'F';
                html += `<div style="background:${isNLGroup ? '#fff3e0' : '#f5f5f5'};padding:10px;border-radius:8px;font-size:0.85rem;">`;
                html += `<div style="font-weight:700;margin-bottom:6px;color:${isNLGroup ? '#e65100' : '#333'};">Groep ${group}</div>`;
                teams.forEach((team, i) => {
                    const isNL = team === 'Nederland';
                    html += `<div style="padding:2px 0;${isNL ? 'font-weight:700;color:#e65100;' : ''}">${team}</div>`;
                });
                html += '</div>';
            }

            html += '</div></div>';
            return html;
        }

        // Fetch from OpenFootball GitHub (historical data, updated daily)
        async function fetchFromOpenFootball() {
            const allMatches = [];

            // Fetch all leagues in parallel
            const leaguePromises = CONFIG.LEAGUES.map(async (league) => {
                try {
                    const response = await fetch(`${CONFIG.OPENFOOTBALL_URL}/${league.file}`);
                    if (!response.ok) {
                        console.warn(`Failed to fetch ${league.name}`);
                        return [];
                    }

                    const data = await response.json();
                    const matches = [];

                    // Parse matches - structure is { matches: [...] }
                    if (data.matches && Array.isArray(data.matches)) {
                        data.matches.forEach(match => {
                            const matchDate = new Date(match.date + 'T' + (match.time || '15:00'));
                            const hasScore = match.score && match.score.ft;

                            matches.push({
                                date: matchDate,
                                time: match.time || '15:00',
                                home: match.team1,
                                away: match.team2,
                                competition: league.name,
                                channel: league.channel,
                                score: hasScore ? `${match.score.ft[0]}-${match.score.ft[1]}` : null,
                                live: false,
                                status: hasScore ? 'FINISHED' : 'SCHEDULED'
                            });
                        });
                    }

                    console.log(`Loaded ${matches.length} matches from ${league.name}`);
                    return matches;
                } catch (error) {
                    console.error(`Error fetching ${league.name}:`, error);
                    return [];
                }
            });

            const results = await Promise.all(leaguePromises);
            results.forEach(matches => allMatches.push(...matches));

            console.log(`Total matches loaded: ${allMatches.length}`);

            // Filter to show only matches within 2 weeks range
            const today = new Date();
            const twoWeeksAgo = new Date(today);
            twoWeeksAgo.setDate(twoWeeksAgo.getDate() - 14);
            const twoWeeksAhead = new Date(today);
            twoWeeksAhead.setDate(twoWeeksAhead.getDate() + 14);

            const filtered = allMatches.filter(match =>
                match.date >= twoWeeksAgo && match.date <= twoWeeksAhead
            );

            console.log(`Matches in date range: ${filtered.length}`);
            return filtered;
        }

        // Fetch darts events from TheSportsDB
        async function fetchDartsEvents() {
            console.log('Fetching darts events from TheSportsDB...');
            const allEvents = [];

            try {
                // Fetch next 15 events for PDC Darts
                const nextResponse = await fetch(`${CONFIG.THESPORTSDB_URL}/eventsnextleague.php?id=${CONFIG.DARTS_LEAGUE_ID}`);
                if (nextResponse.ok) {
                    const nextData = await nextResponse.json();
                    if (nextData.events) {
                        nextData.events.forEach(event => {
                            const eventDate = new Date(event.dateEvent + 'T' + (event.strTime || '19:30:00'));
                            allEvents.push({
                                date: eventDate,
                                time: event.strTime ? event.strTime.substring(0, 5) : '19:30',
                                title: event.strEvent,
                                location: event.strVenue || event.strCountry || '',
                                competition: event.strLeague || 'PDC Darts',
                                channel: 'Viaplay',
                                homePlayer: event.strHomeTeam,
                                awayPlayer: event.strAwayTeam,
                                homeBadge: event.strHomeTeamBadge,
                                awayBadge: event.strAwayTeamBadge,
                                score: null,
                                live: false,
                                status: 'SCHEDULED'
                            });
                        });
                    }
                }

                // Fetch last 15 events (past results)
                const pastResponse = await fetch(`${CONFIG.THESPORTSDB_URL}/eventspastleague.php?id=${CONFIG.DARTS_LEAGUE_ID}`);
                if (pastResponse.ok) {
                    const pastData = await pastResponse.json();
                    if (pastData.events) {
                        pastData.events.forEach(event => {
                            const eventDate = new Date(event.dateEvent + 'T' + (event.strTime || '19:30:00'));
                            const hasScore = event.intHomeScore !== null && event.intAwayScore !== null;
                            allEvents.push({
                                date: eventDate,
                                time: event.strTime ? event.strTime.substring(0, 5) : '19:30',
                                title: event.strEvent,
                                location: event.strVenue || event.strCountry || '',
                                competition: event.strLeague || 'PDC Darts',
                                channel: 'Viaplay',
                                homePlayer: event.strHomeTeam,
                                awayPlayer: event.strAwayTeam,
                                homeBadge: event.strHomeTeamBadge,
                                awayBadge: event.strAwayTeamBadge,
                                score: hasScore ? `${event.intHomeScore}-${event.intAwayScore}` : null,
                                live: false,
                                status: hasScore ? 'FINISHED' : 'SCHEDULED'
                            });
                        });
                    }
                }

                console.log(`Got ${allEvents.length} darts events from TheSportsDB`);
                return allEvents;

            } catch (error) {
                console.error('TheSportsDB Darts API failed:', error);
                // Fallback to static calendar
                return getStaticDartsEvents();
            }
        }

        // Get static darts events as fallback
        function getStaticDartsEvents() {
            const events = [];
            const today = new Date();
            today.setHours(0, 0, 0, 0);

            for (let i = -7; i < 365; i++) {
                const date = new Date(today);
                date.setDate(date.getDate() + i);
                const dateStr = date.toISOString().split('T')[0];

                dartsCalendar
                    .filter(event => event.date === dateStr)
                    .forEach(event => {
                        events.push({
                            date: new Date(event.date + 'T' + event.time),
                            time: event.time,
                            title: event.event,
                            location: event.location,
                            competition: event.event,
                            channel: event.channel,
                            matches: event.matches || null,
                            score: null,
                            live: isLiveNow(event.date + 'T' + event.time, null, 3)
                        });
                    });
            }
            return events;
        }

        // Check if event is live now
        function isLiveNow(startTime, endTime, durationHours = 2) {
            const now = new Date();
            const start = new Date(startTime);
            const end = endTime ? new Date(endTime) : new Date(start.getTime() + durationHours * 60 * 60 * 1000);
            return now >= start && now <= end;
        }

        // ============================================
        // RENDER FUNCTIONS
        // ============================================

        function formatDate(date) {
            const days = ['Zondag', 'Maandag', 'Dinsdag', 'Woensdag', 'Donderdag', 'Vrijdag', 'Zaterdag'];
            const months = ['januari', 'februari', 'maart', 'april', 'mei', 'juni', 'juli', 'augustus', 'september', 'oktober', 'november', 'december'];

            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const compareDate = new Date(date);
            compareDate.setHours(0, 0, 0, 0);

            const diffDays = Math.round((compareDate - today) / (1000 * 60 * 60 * 24));

            if (diffDays === 0) return 'Vandaag';
            if (diffDays === 1) return 'Morgen';
            if (diffDays === -1) return 'Gisteren';

            return `${days[date.getDay()]} ${date.getDate()} ${months[date.getMonth()]}`;
        }

        function isSameDay(date1, date2) {
            return date1.getFullYear() === date2.getFullYear() &&
                   date1.getMonth() === date2.getMonth() &&
                   date1.getDate() === date2.getDate();
        }

        function showLoading() {
            const container = document.getElementById('events-container');
            container.innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Wedstrijden ophalen...</p>
                </div>
            `;
        }

        function showError(message) {
            const container = document.getElementById('events-container');
            container.innerHTML = `
                <div class="error-message">
                    <p>${message}</p>
                </div>
            `;
        }

        async function renderEvents() {
            const container = document.getElementById('events-container');
            container.className = `events-container sport-${currentSport}`;

            showLoading();

            let allEvents = [];
            const today = new Date();
            today.setHours(0, 0, 0, 0);

            try {
                if (currentSport === 'f1') {
                    if (!cachedData.f1) {
                        cachedData.f1 = await fetchF1Sessions();
                    }
                    allEvents = cachedData.f1;
                } else if (currentSport === 'voetbal') {
                    if (!cachedData.voetbal) {
                        cachedData.voetbal = await fetchFootballMatches();
                    }
                    // Make sure we have an array
                    const matches = cachedData.voetbal || [];
                    console.log(`Totaal ${matches.length} wedstrijden opgehaald`);
                    console.log('Actieve filters:', filters);

                    allEvents = matches.filter(e => {
                        // Filter by competitions (if any selected)
                        if (filters.competitions && filters.competitions.length > 0) {
                            if (!filters.competitions.includes(e.competition)) return false;
                        }

                        // Filter by clubs (if any specified)
                        if (filters.clubs && filters.clubs.length > 0) {
                            const homeMatch = filters.clubs.some(club =>
                                e.home && e.home.toLowerCase().includes(club.toLowerCase()));
                            const awayMatch = filters.clubs.some(club =>
                                e.away && e.away.toLowerCase().includes(club.toLowerCase()));
                            if (!homeMatch && !awayMatch) return false;
                        }

                        return true;
                    });
                    console.log(`Na filtering: ${allEvents.length} wedstrijden`);
                } else if (currentSport === 'darts') {
                    // Use static calendar (TheSportsDB returns incorrect data)
                    if (!cachedData.darts) {
                        cachedData.darts = getStaticDartsEvents();
                    }
                    allEvents = cachedData.darts;
                }
            } catch (error) {
                showError('Kon data niet ophalen. Probeer het later opnieuw.');
                return;
            }

            // Update API status
            const statusEl = document.getElementById('api-status');
            const source = localStorage.getItem('footballSource') || 'api';
            if (currentSport === 'voetbal') {
                if (allEvents.length === 0) {
                    statusEl.innerHTML = '<span class="live-dot" style="background: #e10600;"></span> Geen data beschikbaar <button class="refresh-btn" onclick="location.reload()">Ververs</button>';
                } else if (source === 'static') {
                    statusEl.innerHTML = '<span class="live-dot" style="background: #ff9800;"></span> iservoetbalvanavond.nl <button class="refresh-btn" id="refresh-btn">Ververs</button>';
                } else if (source === 'cache') {
                    statusEl.innerHTML = '<span class="live-dot" style="background: #ff9800;"></span> Gecachede data <button class="refresh-btn" id="refresh-btn">Ververs</button>';
                } else {
                    statusEl.innerHTML = '<span class="live-dot"></span> API-Football <button class="refresh-btn" id="refresh-btn">Ververs</button>';
                }
            } else if (currentSport === 'f1') {
                statusEl.innerHTML = '<span class="live-dot"></span> OpenF1 <button class="refresh-btn" id="refresh-btn">Ververs</button>';
            } else if (currentSport === 'darts') {
                statusEl.innerHTML = '<span class="live-dot" style="background: #ff9800;"></span> PDC Kalender <button class="refresh-btn" id="refresh-btn">Ververs</button>';
            }

            // Re-attach refresh button handler
            const refreshBtn = document.getElementById('refresh-btn');
            if (refreshBtn) {
                refreshBtn.onclick = () => {
                    localStorage.removeItem('footballCache');
                    localStorage.removeItem('footballCacheTime');
                    localStorage.removeItem('footballSource');
                    cachedData = { voetbal: null, darts: null, f1: null };
                    renderEvents();
                };
            }

            // Filter events based on date range
            const weekAgo = new Date(today);
            weekAgo.setDate(weekAgo.getDate() - 7);
            const twoWeeksAhead = new Date(today);
            twoWeeksAhead.setDate(twoWeeksAhead.getDate() + 14);

            const filteredEvents = allEvents.filter(e => {
                const eventDate = new Date(e.date);
                eventDate.setHours(0, 0, 0, 0);

                // Always show future events (from today onwards)
                if (eventDate >= today) return true;

                // Show past events only if toggle is active
                if (showPast && eventDate >= weekAgo) return true;

                return false;
            });

            // Group events by date
            const eventsByDate = {};
            filteredEvents.forEach(event => {
                const dateKey = event.date.toISOString().split('T')[0];
                if (!eventsByDate[dateKey]) {
                    eventsByDate[dateKey] = [];
                }
                eventsByDate[dateKey].push(event);
            });

            // Sort dates
            const sortedDates = Object.keys(eventsByDate).sort();

            if (sortedDates.length === 0) {
                const sportNames = { voetbal: 'voetbal', darts: 'darts', f1: 'Formule 1' };
                const icons = { voetbal: '&#9917;', darts: '&#127919;', f1: '&#127959;' };
                container.innerHTML = `
                    <div class="no-events">
                        <div class="icon">${icons[currentSport]}</div>
                        <h3>Geen ${sportNames[currentSport]} gevonden</h3>
                        <p>Er zijn geen uitzendingen gevonden voor de komende periode.</p>
                    </div>
                `;
                return;
            }

            let html = '';
            let todayAnchorSet = false;

            sortedDates.forEach(dateKey => {
                const events = eventsByDate[dateKey];
                const eventDate = new Date(dateKey + 'T12:00:00');
                const isToday = isSameDay(eventDate, today);
                const isPast = eventDate < today;

                // Add anchor for today
                const todayAnchor = isToday && !todayAnchorSet ? 'id="today-anchor"' : '';
                if (isToday) todayAnchorSet = true;

                html += `<div class="day-section ${isPast ? 'past-day' : ''}" ${todayAnchor}>
                    <h2 class="day-header">${isToday ? 'Vandaag' : formatDate(eventDate)}</h2>`;

                events.sort((a, b) => a.time.localeCompare(b.time)).forEach(event => {
                    let titleHtml = '';
                    if (currentSport === 'voetbal') {
                        const homeCrest = event.homeCrest ? `<img src="${event.homeCrest}" class="club-logo" alt="">` : '';
                        const awayCrest = event.awayCrest ? `<img src="${event.awayCrest}" class="club-logo" alt="">` : '';
                        titleHtml = `${homeCrest}<span class="team-name">${event.home}</span> - <span class="team-name">${event.away}</span>${awayCrest}`;
                    } else if (currentSport === 'f1') {
                        titleHtml = event.title;
                    } else if (currentSport === 'darts') {
                        titleHtml = event.title;
                        if (event.location) {
                            titleHtml += ` <span style="color:#888;font-size:0.9em;">- ${event.location}</span>`;
                        }
                        if (event.matches && event.matches.length > 0) {
                            titleHtml += `<span class="expand-icon">â–¼</span>`;
                        }
                    }

                    const scoreText = event.score || '-';
                    const liveHtml = event.live ? `<span class="live-badge">LIVE</span>` : '';
                    const channelLogo = CONFIG.CHANNEL_LOGOS[event.channel];
                    const channelHtml = channelLogo
                        ? `<img src="${channelLogo}" class="channel-logo" alt="${event.channel}">`
                        : `<span class="channel-text">${event.channel}</span>`;

                    const hasMatches = event.matches && event.matches.length > 0;
                    let matchesHtml = '';
                    if (hasMatches) {
                        matchesHtml = '<div class="matches-list">';
                        event.matches.forEach(m => {
                            const homePlayer = dartsPlayers[m.home] || {name: m.home};
                            const awayPlayer = dartsPlayers[m.away] || {name: m.away};
                            const timeStr = m.time ? `<span class="match-time">${m.time}</span>` : '';
                            if (m.away) {
                                matchesHtml += `<div class="match-item">${timeStr}${homePlayer.name}<span class="vs">-</span>${awayPlayer.name}</div>`;
                            } else {
                                matchesHtml += `<div class="match-item">${timeStr}${homePlayer.name}</div>`;
                            }
                        });
                        matchesHtml += '</div>';
                    }

                    html += `
                        <div class="event-card ${isPast ? 'past-event' : ''} ${hasMatches ? 'has-matches' : ''}">
                            <div class="event-time">${event.time}</div>
                            <div class="event-details">
                                <div class="event-title">
                                    ${titleHtml}
                                    ${liveHtml}
                                </div>
                                <div class="event-meta">
                                    <span class="competition-badge">${event.competition}</span>
                                    ${event.circuit ? `<span>${event.circuit}</span>` : ''}
                                </div>
                            </div>
                            <div class="event-score-col ${event.score ? '' : 'no-score'}">${scoreText}</div>
                            <div class="event-channel">${channelHtml}</div>
                            ${matchesHtml}
                        </div>
                    `;
                });

                html += '</div>';
            });

            container.innerHTML = html;

            if (showScores) {
                container.classList.add('show-scores');
            }

            // Scroll to today if showing past events
            if (showPast) {
                const todayEl = document.getElementById('today-anchor');
                if (todayEl) {
                    todayEl.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            }

            // Add click handlers for expandable darts cards
            container.querySelectorAll('.event-card.has-matches').forEach(card => {
                card.addEventListener('click', () => {
                    card.classList.toggle('expanded');
                });
            });
        }

        // Render standings
        async function renderStandings() {
            const tabsContainer = document.getElementById('standings-tabs');
            const contentContainer = document.getElementById('standings-content');

            if (currentSport === 'voetbal') {
                // Football standings - show tabs for each league
                const leagues = [
                    { id: 88, name: 'Eredivisie' },
                    { id: 39, name: 'Premier League' },
                    { id: 78, name: 'Bundesliga' },
                    { id: 140, name: 'La Liga' },
                    { id: 135, name: 'Serie A' },
                    { id: 61, name: 'Ligue 1' },
                    { id: 2, name: 'Champions League' },
                    { id: 'wk2026', name: 'WK 2026' }
                ];

                tabsContainer.innerHTML = leagues.map((l, i) =>
                    `<button class="standings-tab ${i === 0 ? 'active' : ''}" data-league="${l.id}">${l.name}</button>`
                ).join('');

                contentContainer.innerHTML = '<div class="loading"><div class="spinner"></div><p>Stand ophalen...</p></div>';

                // Load first league
                await loadFootballStandings(leagues[0].id, leagues[0].name);

                // Add tab handlers
                tabsContainer.querySelectorAll('.standings-tab').forEach(tab => {
                    tab.addEventListener('click', async () => {
                        tabsContainer.querySelectorAll('.standings-tab').forEach(t => t.classList.remove('active'));
                        tab.classList.add('active');
                        const leagueId = tab.dataset.league;
                        // Handle both numeric IDs and string IDs (like 'wk2026')
                        const league = leagues.find(l => String(l.id) === leagueId);
                        if (league) {
                            await loadFootballStandings(league.id, league.name);
                        }
                    });
                });

            } else if (currentSport === 'darts') {
                tabsContainer.innerHTML = '<button class="standings-tab active">Premier League</button>';
                contentContainer.innerHTML = renderDartsStandings();

            } else if (currentSport === 'f1') {
                tabsContainer.innerHTML = `
                    <button class="standings-tab active" data-type="drivers">Coureurs</button>
                    <button class="standings-tab" data-type="constructors">Constructeurs</button>
                `;
                contentContainer.innerHTML = '<div class="loading"><div class="spinner"></div><p>Stand ophalen...</p></div>';

                const f1Data = await fetchF1Standings();
                renderF1Standings(f1Data, 'drivers');

                tabsContainer.querySelectorAll('.standings-tab').forEach(tab => {
                    tab.addEventListener('click', () => {
                        tabsContainer.querySelectorAll('.standings-tab').forEach(t => t.classList.remove('active'));
                        tab.classList.add('active');
                        renderF1Standings(f1Data, tab.dataset.type);
                    });
                });
            }
        }

        async function loadFootballStandings(leagueId, leagueName) {
            const contentContainer = document.getElementById('standings-content');

            // Special case: WK 2026 groups
            if (leagueId === 'wk2026') {
                contentContainer.innerHTML = renderWK2026Groups();
                return;
            }

            contentContainer.innerHTML = '<div class="loading"><div class="spinner"></div><p>Stand ophalen...</p></div>';

            const standings = await fetchFootballStandings(leagueId);

            if (!standings || standings.length === 0) {
                contentContainer.innerHTML = '<div class="no-events"><p>Geen stand beschikbaar</p></div>';
                return;
            }

            // Check if using cached/static data
            const cacheKey = `standings_${leagueId}`;
            const cacheTime = localStorage.getItem(cacheKey + '_time');
            const isStatic = !cacheTime;

            let html = `<div class="standings-container">
                <div class="standings-title">${leagueName}${isStatic ? ' <span style="font-size:0.7em;color:#999;">(snapshot)</span>' : ''}</div>
                <table class="standings-table">
                    <tr><th class="pos">#</th><th>Club</th><th class="stats">W</th><th class="stats">G</th><th class="stats">V</th><th class="stats">+/-</th><th class="pts">Ptn</th></tr>`;

            standings.forEach(team => {
                const logo = team.team.logo ? `<img src="${team.team.logo}" class="team-logo" alt="">` : '';
                html += `<tr>
                    <td class="pos">${team.rank}</td>
                    <td><div class="team">${logo}${team.team.name}</div></td>
                    <td class="stats">${team.all.win}</td>
                    <td class="stats">${team.all.draw}</td>
                    <td class="stats">${team.all.lose}</td>
                    <td class="stats">${team.goalsDiff > 0 ? '+' : ''}${team.goalsDiff}</td>
                    <td class="pts">${team.points}</td>
                </tr>`;
            });

            html += '</table></div>';
            contentContainer.innerHTML = html;
        }

        function renderDartsStandings() {
            let html = `<div class="standings-container">
                <div class="standings-title">Premier League Darts 2026 <span style="font-size:0.7em;color:#999;">(na Night 1)</span></div>
                <table class="standings-table">
                    <tr><th class="pos">#</th><th>Speler</th><th class="stats">GS</th><th class="stats">HF</th><th class="stats">F</th><th class="stats">W</th><th class="pts">Ptn</th></tr>`;

            plDartsStandings.forEach(player => {
                html += `<tr>
                    <td class="pos">${player.pos}</td>
                    <td>${player.name}</td>
                    <td class="stats">${player.played}</td>
                    <td class="stats">${player.sf}</td>
                    <td class="stats">${player.f}</td>
                    <td class="stats">${player.w}</td>
                    <td class="pts">${player.pts}</td>
                </tr>`;
            });

            html += '</table></div>';
            return html;
        }

        function renderF1Standings(data, type) {
            const contentContainer = document.getElementById('standings-content');

            if (type === 'drivers') {
                if (!data.drivers.length) {
                    contentContainer.innerHTML = '<div class="no-events"><p>Kon coureurs stand niet ophalen</p></div>';
                    return;
                }

                let html = `<div class="standings-container">
                    <div class="standings-title">F1 Coureurs Kampioenschap 2026</div>
                    <table class="standings-table">
                        <tr><th class="pos">#</th><th>Coureur</th><th>Team</th><th class="pts">Ptn</th></tr>`;

                data.drivers.forEach(d => {
                    html += `<tr>
                        <td class="pos">${d.position}</td>
                        <td>${d.Driver.givenName} ${d.Driver.familyName}</td>
                        <td>${d.Constructors[0]?.name || ''}</td>
                        <td class="pts">${d.points}</td>
                    </tr>`;
                });

                html += '</table></div>';
                contentContainer.innerHTML = html;

            } else {
                if (!data.constructors.length) {
                    contentContainer.innerHTML = '<div class="no-events"><p>Kon constructeurs stand niet ophalen</p></div>';
                    return;
                }

                let html = `<div class="standings-container">
                    <div class="standings-title">F1 Constructeurs Kampioenschap 2026</div>
                    <table class="standings-table">
                        <tr><th class="pos">#</th><th>Team</th><th class="pts">Ptn</th></tr>`;

                data.constructors.forEach(c => {
                    html += `<tr>
                        <td class="pos">${c.position}</td>
                        <td>${c.Constructor.name}</td>
                        <td class="pts">${c.points}</td>
                    </tr>`;
                });

                html += '</table></div>';
                contentContainer.innerHTML = html;
            }
        }

        // ============================================
        // EVENT LISTENERS
        // ============================================

        function updateFilterVisibility() {
            const filtersRow = document.getElementById('filters-row');
            const compDropdown = document.getElementById('comp-dropdown');
            const clubInput = document.getElementById('filter-clubs');
            const resetBtn = document.getElementById('reset-filters');

            if (currentSport === 'voetbal') {
                filtersRow.style.display = 'flex';
                compDropdown.style.display = 'block';
                clubInput.style.display = 'block';
                resetBtn.style.display = 'block';
            } else {
                // Show only toggles for darts and F1
                filtersRow.style.display = 'flex';
                compDropdown.style.display = 'none';
                clubInput.style.display = 'none';
                resetBtn.style.display = 'none';
            }
        }

        document.querySelectorAll('.sport-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.sport-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                currentSport = tab.dataset.sport;
                updateFilterVisibility();
                if (currentView === 'standen') {
                    renderStandings();
                } else {
                    renderEvents();
                }
            });
        });

        // View toggle (Programma / Standen)
        document.querySelectorAll('.view-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentView = btn.dataset.view;

                const eventsContainer = document.getElementById('events-container');
                const standingsWrapper = document.getElementById('standings-wrapper');

                if (currentView === 'standen') {
                    eventsContainer.style.display = 'none';
                    standingsWrapper.style.display = 'block';
                    renderStandings();
                } else {
                    eventsContainer.style.display = 'block';
                    standingsWrapper.style.display = 'none';
                    renderEvents();
                }
            });
        });

        document.getElementById('toggle-past').addEventListener('change', function() {
            showPast = this.checked;
            renderEvents();
        });

        document.getElementById('toggle-scores').addEventListener('change', function() {
            showScores = this.checked;
            document.getElementById('events-container').classList.toggle('show-scores', showScores);
        });

        // Competition dropdown
        const compBtn = document.getElementById('comp-btn');
        const compContent = document.getElementById('comp-content');
        const compCheckboxes = compContent.querySelectorAll('input[type="checkbox"]');

        // Set initial state from localStorage
        compCheckboxes.forEach(cb => {
            cb.checked = filters.competitions.includes(cb.value);
        });
        updateCompBtnText();

        // Toggle dropdown
        compBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            compContent.classList.toggle('show');
        });

        // Handle checkbox changes
        compCheckboxes.forEach(cb => {
            cb.addEventListener('change', () => {
                filters.competitions = Array.from(compCheckboxes)
                    .filter(c => c.checked)
                    .map(c => c.value);
                localStorage.setItem('selectedCompetitions', JSON.stringify(filters.competitions));
                updateCompBtnText();
                renderEvents();
            });
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            if (!compContent.contains(e.target) && e.target !== compBtn) {
                compContent.classList.remove('show');
            }
        });

        function updateCompBtnText() {
            const count = filters.competitions.length;
            if (count === 0) {
                compBtn.textContent = 'Alle competities â–¾';
            } else if (count === 1) {
                compBtn.textContent = filters.competitions[0] + ' â–¾';
            } else {
                compBtn.textContent = `${count} competities â–¾`;
            }
        }

        // Club filter with debounce (comma separated)
        let clubFilterTimeout;
        const clubInput = document.getElementById('filter-clubs');
        clubInput.value = (filters.clubs || []).join(', ');

        clubInput.addEventListener('input', () => {
            clearTimeout(clubFilterTimeout);
            clubFilterTimeout = setTimeout(() => {
                const value = clubInput.value;
                filters.clubs = value ? value.split(',').map(c => c.trim()).filter(c => c) : [];
                localStorage.setItem('selectedClubs', JSON.stringify(filters.clubs));
                renderEvents();
            }, 300);
        });

        // Reset filters button
        document.getElementById('reset-filters').addEventListener('click', () => {
            // Clear competitions
            filters.competitions = [];
            if (compCheckboxes) compCheckboxes.forEach(cb => cb.checked = false);
            updateCompBtnText();
            localStorage.removeItem('selectedCompetitions');

            // Clear clubs
            filters.clubs = [];
            if (clubInput) clubInput.value = '';
            localStorage.removeItem('selectedClubs');

            // Reset toggles
            document.getElementById('toggle-past').checked = false;
            document.getElementById('toggle-scores').checked = false;
            showPast = false;
            showScores = false;
            document.getElementById('events-container').classList.remove('show-scores');

            renderEvents();
        });


        // ============================================
        // INITIALIZATION
        // ============================================
        console.log('ðŸ Initializing...');
        updateFilterVisibility();
        renderEvents();
        console.log('âœ… Init complete');

        // Auto-refresh every 5 minutes
        setInterval(() => {
            cachedData = { voetbal: null, darts: null, f1: null };
            renderEvents();
        }, 5 * 60 * 1000);
    </script>
</body>
</html>
